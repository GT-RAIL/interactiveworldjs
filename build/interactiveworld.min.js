var INTERACTIVEWORLD=INTERACTIVEWORLD||{REVISION:"1-devel"};INTERACTIVEWORLD.Z_INDEX=.005,INTERACTIVEWORLD.NORTH_WALL=0,INTERACTIVEWORLD.EAST_WALL=1,INTERACTIVEWORLD.SOUTH_WALL=2,INTERACTIVEWORLD.WEST_WALL=3,INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE=0,INTERACTIVEWORLD.POSITIVE_DOOR_SIDE=1,INTERACTIVEWORLD.WORLD_WIDTH=20,INTERACTIVEWORLD.WORLD_HEIGHT=20,INTERACTIVEWORLD.WORLD_FLOOR_TEXTURE="resources/textures/grass.jpg",INTERACTIVEWORLD.WALL_WIDTH=.05,INTERACTIVEWORLD.WALL_HEIGHT=.75,INTERACTIVEWORLD.DOOR_WIDTH=.8,INTERACTIVEWORLD.HALLWAY_WIDTH=1,INTERACTIVEWORLD.ROOM_WIDTH=4.9,INTERACTIVEWORLD.ROOM_HEIGHT=4,INTERACTIVEWORLD.HOUSE_WIDTH=2*INTERACTIVEWORLD.ROOM_WIDTH+INTERACTIVEWORLD.HALLWAY_WIDTH,INTERACTIVEWORLD.HOUSE_HEIGHT=2*INTERACTIVEWORLD.ROOM_HEIGHT+INTERACTIVEWORLD.HALLWAY_WIDTH,INTERACTIVEWORLD.HOUSE_WALL_TEXTURE="resources/textures/bricks.jpg",INTERACTIVEWORLD.HOUSE_FLOOR_TEXTURE="resources/textures/hardwood-light.jpg",INTERACTIVEWORLD.BEDROOM_WALL_TEXTURE="resources/textures/painted-wall-blue.jpg",INTERACTIVEWORLD.BEDROOM_FLOOR_TEXTURE="resources/textures/carpet-grey.jpg",INTERACTIVEWORLD.KITCHEN_WALL_TEXTURE="resources/textures/tile-wall.jpg",INTERACTIVEWORLD.KITCHEN_FLOOR_TEXTURE="resources/textures/tile-floor.jpg",INTERACTIVEWORLD.DINING_ROOM_WALL_TEXTURE="resources/textures/wallpaper-light.jpg",INTERACTIVEWORLD.DINING_ROOM_FLOOR_TEXTURE="resources/textures/hardwood-dark.jpg",INTERACTIVEWORLD.LIVING_ROOM_WALL_TEXTURE="resources/textures/painted-wall-red.jpg",INTERACTIVEWORLD.LIVING_ROOM_FLOOR_TEXTURE="resources/textures/carpet-tan.jpg",INTERACTIVEWORLD.BED_MODEL="resources/models/bed.dae",INTERACTIVEWORLD.DRESSER_MODEL="resources/models/dresser.dae",INTERACTIVEWORLD.NIGHTSTAND_MODEL="resources/models/nightstand.dae",INTERACTIVEWORLD.DINING_TABLE_MODEL="resources/models/dining-table.dae",INTERACTIVEWORLD.SINK_MODEL="resources/models/sink.dae",INTERACTIVEWORLD.CABINET_MODEL="resources/models/cabinet.dae",INTERACTIVEWORLD.REFRIGERATOR_MODEL="resources/models/refrigerator.dae",INTERACTIVEWORLD.OVEN_MODEL="resources/models/oven.dae",INTERACTIVEWORLD.COUNTER_MODEL="resources/models/counter.dae",INTERACTIVEWORLD.COUCH_MODEL="resources/models/couch.dae",INTERACTIVEWORLD.TV_MODEL="resources/models/tv.dae",INTERACTIVEWORLD.COFFEE_TABLE_MODEL="resources/models/coffee-table.dae",INTERACTIVEWORLD.RUG_TEXTURE="resources/textures/rug.jpg",INTERACTIVEWORLD.Bed=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.BED_MODEL,function(b){b.scene.position.x=-.04,b.scene.position.y=2.17,b.scene.rotation.z=-Math.PI/2,a.add(b.scene)})},INTERACTIVEWORLD.Bed.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Cabinet=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.CABINET_MODEL,function(b){b.scene.position.y=.1,a.add(b.scene)})},INTERACTIVEWORLD.Cabinet.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.CoffeeTable=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.COFFEE_TABLE_MODEL,function(b){b.scene.position.y=.75,b.scene.rotation.z=-Math.PI/2,b.scene.scale.x*=.11,b.scene.scale.y*=.11,b.scene.scale.z*=.11,a.add(b.scene)})},INTERACTIVEWORLD.CoffeeTable.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Couch=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.COUCH_MODEL,function(b){b.scene.position.x=-.7,b.scene.position.y=.55,a.add(b.scene)})},INTERACTIVEWORLD.Couch.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Counter=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.COUNTER_MODEL,function(b){b.scene.position.x=1.65,b.scene.position.y=1.95,b.scene.scale.x*=.85,b.scene.scale.y*=.85,b.scene.scale.z*=.85,a.add(b.scene)})},INTERACTIVEWORLD.Counter.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.DiningTable=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.DINING_TABLE_MODEL,function(b){b.scene.position.x=2.4,b.scene.position.y=1.75,a.add(b.scene)})},INTERACTIVEWORLD.DiningTable.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Dresser=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.DRESSER_MODEL,function(b){b.scene.position.x=-17.32,b.scene.position.y=-11.55,a.add(b.scene)})},INTERACTIVEWORLD.Dresser.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Nightstand=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.NIGHTSTAND_MODEL,function(b){b.scene.position.x=-.95,b.scene.position.y=-.69,b.scene.position.z=-.1,a.add(b.scene)})},INTERACTIVEWORLD.Nightstand.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Oven=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.OVEN_MODEL,function(b){b.scene.position.x=-.45,b.scene.position.y=-.2,a.add(b.scene)})},INTERACTIVEWORLD.Oven.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Refrigerator=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.REFRIGERATOR_MODEL,function(b){b.scene.position.x=-.15,b.scene.position.y=1.15,b.scene.rotation.z=-Math.PI/2,a.add(b.scene)})},INTERACTIVEWORLD.Refrigerator.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Sink=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.SINK_MODEL,function(b){b.scene.position.x=-.3,b.scene.position.y=-.2,a.add(b.scene)})},INTERACTIVEWORLD.Sink.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.TV=function(){var a=this;THREE.Object3D.call(this);var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.TV_MODEL,function(b){b.scene.position.x=1.3,b.scene.position.y=.6,b.scene.scale.x*=.66,b.scene.scale.y*=.66,b.scene.scale.z*=.66,a.add(b.scene)})},INTERACTIVEWORLD.TV.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.TexturePlane=function(a){a=a||{};var b=a.width,c=a.height,d=a.texture,e=a.repeat,f=new THREE.ImageUtils.loadTexture(d);f.wrapS=f.wrapT=THREE.RepeatWrapping,f.repeat.set(e,e),THREE.Mesh.call(this,new THREE.PlaneGeometry(b,c),new THREE.MeshLambertMaterial({map:f}))},INTERACTIVEWORLD.TexturePlane.prototype.__proto__=THREE.Mesh.prototype,INTERACTIVEWORLD.Wall=function(a){a=a||{};var b=a.length,c=a.texture,d=new THREE.ImageUtils.loadTexture(c);d.wrapS=d.wrapT=THREE.RepeatWrapping,d.repeat.set(b,1),THREE.Mesh.call(this,new THREE.CubeGeometry(b,INTERACTIVEWORLD.WALL_WIDTH,INTERACTIVEWORLD.WALL_HEIGHT),new THREE.MeshLambertMaterial({map:d,side:THREE.DoubleSide})),this.position.z=INTERACTIVEWORLD.WALL_HEIGHT/2},INTERACTIVEWORLD.Wall.prototype.__proto__=THREE.Mesh.prototype,INTERACTIVEWORLD.Bedroom=function(){THREE.Object3D.call(this),this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.BEDROOM_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.BEDROOM_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.EAST_WALL,doorSide:INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE}));var a=new INTERACTIVEWORLD.Bed,b=new INTERACTIVEWORLD.Nightstand,c=new INTERACTIVEWORLD.Nightstand,d=new INTERACTIVEWORLD.Dresser;a.position.x=-.8,a.position.y=-.2,b.position.x=1.25,b.position.y=1.3,c.position.x=-2,c.position.y=1.3,d.position.x=.645,d.position.y=-1.45,d.rotation.z=Math.PI,this.add(a),this.add(b),this.add(c),this.add(d)},INTERACTIVEWORLD.Bedroom.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.DiningRoom=function(){THREE.Object3D.call(this),this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.DINING_ROOM_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.DINING_ROOM_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.NORTH_WALL,doorSide:INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE}));var a=new INTERACTIVEWORLD.DiningTable,b=new INTERACTIVEWORLD.Cabinet,c=new INTERACTIVEWORLD.TexturePlane({width:3.2,height:2,texture:INTERACTIVEWORLD.RUG_TEXTURE,repeat:1});a.position.x=-1.2,a.position.y=-.3,b.position.x=-.55,b.position.y=-1.4,b.rotation.z=Math.PI,c.position.x=.3,c.position.y=.6,c.position.z=3*INTERACTIVEWORLD.Z_INDEX,this.add(a),this.add(b),this.add(c)},INTERACTIVEWORLD.DiningRoom.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.House=function(){THREE.Object3D.call(this);var a=new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.HOUSE_WIDTH,height:INTERACTIVEWORLD.HOUSE_HEIGHT,floor:INTERACTIVEWORLD.HOUSE_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.HOUSE_WALL_TEXTURE});a.position.z=-INTERACTIVEWORLD.Z_INDEX,this.add(a);var b=INTERACTIVEWORLD.WALL_WIDTH/2,c=new INTERACTIVEWORLD.Bedroom;c.position.x=-(INTERACTIVEWORLD.ROOM_WIDTH/2)-(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)+b,c.position.y=INTERACTIVEWORLD.ROOM_HEIGHT/2+(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)-b,this.add(c);var d=new INTERACTIVEWORLD.Kitchen;d.position.x=INTERACTIVEWORLD.ROOM_WIDTH/2+(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)-b,d.position.y=INTERACTIVEWORLD.ROOM_HEIGHT/2+(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)-b,this.add(d);var e=new INTERACTIVEWORLD.LivingRoom;e.position.x=-(INTERACTIVEWORLD.ROOM_WIDTH/2)-(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)+b,e.position.y=-(INTERACTIVEWORLD.ROOM_HEIGHT/2)-(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)+b,this.add(e);var f=new INTERACTIVEWORLD.DiningRoom;f.position.x=INTERACTIVEWORLD.ROOM_WIDTH/2+(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)-b,f.position.y=-(INTERACTIVEWORLD.ROOM_HEIGHT/2)-(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)+b,this.add(f)},INTERACTIVEWORLD.House.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Kitchen=function(){THREE.Object3D.call(this),this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.KITCHEN_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.KITCHEN_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.SOUTH_WALL,doorSide:INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE}));var a=new INTERACTIVEWORLD.Refrigerator,b=new INTERACTIVEWORLD.Sink,c=new INTERACTIVEWORLD.Oven,d=new INTERACTIVEWORLD.Counter,e=new INTERACTIVEWORLD.Counter;a.position.x=1.2,a.position.y=1.1,b.position.x=-2.2,b.position.y=1.1,c.position.x=1,c.position.y=-1.35,c.rotation.z=Math.PI,d.position.x=2.1,d.position.y=-1.1,d.rotation.z=Math.PI,e.position.x=-.3,e.position.y=-1.1,e.rotation.z=Math.PI,this.add(a),this.add(b),this.add(c),this.add(d),this.add(e)},INTERACTIVEWORLD.Kitchen.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.LivingRoom=function(){THREE.Object3D.call(this),this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.LIVING_ROOM_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.LIVING_ROOM_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.EAST_WALL,doorSide:INTERACTIVEWORLD.POSITIVE_DOOR_SIDE}));var a=new INTERACTIVEWORLD.Couch,b=new INTERACTIVEWORLD.TV,c=new INTERACTIVEWORLD.CoffeeTable;a.position.x=-.65,a.position.y=-1.95,a.rotation.z=Math.PI/2,b.position.x=1.7,b.position.y=.5,b.rotation.z=-Math.PI/2,c.position.x=-.15,c.position.y=.7,c.rotation.z=-Math.PI/2,this.add(a),this.add(b),this.add(c)},INTERACTIVEWORLD.LivingRoom.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Room=function(a){THREE.Object3D.call(this),a=a||{};var b=a.width,c=a.height,d=a.withDoor,e=a.doorWall,f=a.doorSide,g=a.floor,h=a.wall;this.add(new INTERACTIVEWORLD.TexturePlane({width:b,height:c,texture:g,repeat:4}));var i=new INTERACTIVEWORLD.Wall({length:b,texture:h});i.position.y=c/2;var j=new INTERACTIVEWORLD.Wall({length:c,texture:h});j.position.x=b/2,j.rotation.z=Math.PI/2;var k=new INTERACTIVEWORLD.Wall({length:b,texture:h});k.position.y=-c/2;var l=new INTERACTIVEWORLD.Wall({length:c,texture:h});l.position.x=-b/2,l.rotation.z=Math.PI/2,d&&(e===INTERACTIVEWORLD.NORTH_WALL?(i=new INTERACTIVEWORLD.Wall({length:b-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),i.position.y=c/2,i.position.x=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2):e===INTERACTIVEWORLD.EAST_WALL?(j=new INTERACTIVEWORLD.Wall({length:c-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),j.position.x=b/2,j.rotation.z=Math.PI/2,j.position.y=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2):e===INTERACTIVEWORLD.SOUTH_WALL?(k=new INTERACTIVEWORLD.Wall({length:b-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),k.position.y=-c/2,k.position.x=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2):(l=new INTERACTIVEWORLD.Wall({length:c-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),l.position.x=-b/2,l.rotation.z=Math.PI/2,l.position.y=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2)),this.add(i),this.add(j),this.add(k),this.add(l)},INTERACTIVEWORLD.Room.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.MouseControls=function(a){function b(a){switch(a.preventDefault(),a.button){case 0:n=m.PAN,k.set(a.clientX,a.clientY);break;case 2:n=m.ROTATE,j.set(a.clientX,a.clientY)}g.domElement.addEventListener("mousemove",c,!1),g.domElement.addEventListener("mouseup",d,!1)}function c(a){a.preventDefault();var b=a.movementX||a.mozMovementX||a.webkitMovementX||0,c=a.movementY||a.mozMovementY||a.webkitMovementY||0;switch(n){case m.ROTATE:i.position.x=i.position.x,i.position.y=i.position.y,i.rotation.z-=.002*(b-c);break;case m.PAN:i.translateX(.01*-b),i.translateY(.01*c)}}function d(a){a.preventDefault(),g.domElement.removeEventListener("mousemove",c,!1),g.domElement.removeEventListener("mouseup",d,!1),n=m.NONE}function e(a){a.preventDefault();var b=0;a.wheelDelta?b=a.wheelDelta:a.detail&&(b=-a.detail),b>0?g.dollyOut():g.dollyIn()}function f(a){a.preventDefault();var b=new THREE.Vector3(2*(a.clientX/window.innerWidth)-1,2*-(a.clientY/window.innerHeight)+1,.5);l.unprojectVector(b,g.camera),g.camera.updateMatrixWorld();var c=new THREE.Vector3;c.getPositionFromMatrix(g.camera.matrixWorld);var d=new THREE.Raycaster(c,b.sub(c).normalize()),e=d.intersectObjects(h);e.length>0&&(e[0].object.material.color.setHex(16777215*Math.random()),console.log("hit"))}var g=this;a=a||{},this.camera=a.camera,this.scene=a.scene,this.domElement=a.domElement;var h=a.objects;this.camera.position.z=4*INTERACTIVEWORLD.WALL_HEIGHT;var i=new THREE.Object3D;i.add(this.camera),this.scene.add(i),i.position.z=3*INTERACTIVEWORLD.WALL_HEIGHT,this.target=new THREE.Vector3,this.EPS=1e-6,this.phiDelta=0,this.thetaDelta=0,this.scale=1,this.pan=new THREE.Vector3,this.zoomSpeed=1,this.autoRotateSpeed=2;var j=new THREE.Vector2,k=new THREE.Vector2;this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=1/0,this.lastPosition=new THREE.Vector3;var l=new THREE.Projector,m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2},n=m.NONE;this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",b,!1),this.domElement.addEventListener("mousewheel",e,!1),this.domElement.addEventListener("DOMMouseScroll",e,!1),this.domElement.addEventListener("mousemove",f,!1),this.rotateUp(-.75)},INTERACTIVEWORLD.MouseControls.prototype.__proto__=THREE.EventDispatcher.prototype,INTERACTIVEWORLD.MouseControls.prototype.update=function(){var a=this.camera.position,b=a.clone().sub(this.target),c=Math.atan2(Math.sqrt(b.x*b.x+b.z*b.z),b.y)+this.phiDelta;c=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,c)),c=Math.max(this.EPS,Math.min(Math.PI-this.EPS,c));var d=b.length()*this.scale;d=Math.max(this.minDistance,Math.min(this.maxDistance,d)),b.y=d*Math.cos(c),b.z=d*Math.sin(c),a.copy(this.target).add(b),this.camera.lookAt(this.target),this.phiDelta=0,this.scale=1},INTERACTIVEWORLD.MouseControls.prototype.rotateUp=function(a){void 0===a&&(a=2*Math.PI/60/60*this.autoRotateSpeed),this.phiDelta-=a},INTERACTIVEWORLD.MouseControls.prototype.dollyIn=function(a){void 0===a&&(a=Math.pow(.95,this.zoomSpeed)),this.scale/=a,this.rotateUp(.01)},INTERACTIVEWORLD.MouseControls.prototype.dollyOut=function(a){void 0===a&&(a=Math.pow(.95,this.zoomSpeed)),this.scale*=a,this.rotateUp(-.01)},INTERACTIVEWORLD.Viewer=function(a){function b(){i.update(),f.render(g,h),requestAnimationFrame(b)}var c=[];a=a||{};var d=a.divID,e=a.antialias,f=new THREE.WebGLRenderer({antialias:e});f.setSize(window.innerWidth,window.innerHeight);var g=new THREE.Scene,h=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.01,1e3);g.add(new THREE.AmbientLight(6710886)),g.add(new THREE.HemisphereLight(16777215,11184810,.8)),g.add(new INTERACTIVEWORLD.World);var i=new INTERACTIVEWORLD.MouseControls({scene:g,camera:h,domElement:f.domElement,objects:c});window.addEventListener("resize",function(){h.left=window.innerWidth/-2,h.right=window.innerWidth/2,h.top=window.innerHeight/2,h.bottom=window.innerHeight/-2,h.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight)},!1),document.getElementById(d).appendChild(f.domElement),b()},INTERACTIVEWORLD.World=function(){THREE.Object3D.call(this);var a=new INTERACTIVEWORLD.TexturePlane({width:INTERACTIVEWORLD.WORLD_WIDTH,height:INTERACTIVEWORLD.WORLD_HEIGHT,texture:INTERACTIVEWORLD.WORLD_FLOOR_TEXTURE,repeat:10});a.position.z=2*-INTERACTIVEWORLD.Z_INDEX,this.add(a);var b=THREE.ImageUtils.loadTextureCube(["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"]);b.format=THREE.RGBFormat;var c=THREE.ShaderLib.cube;c.uniforms.tCube.value=b,this.add(new THREE.Mesh(new THREE.CubeGeometry(INTERACTIVEWORLD.WORLD_WIDTH,INTERACTIVEWORLD.WORLD_HEIGHT,Math.max(INTERACTIVEWORLD.WORLD_WIDTH,INTERACTIVEWORLD.WORLD_HEIGHT)),new THREE.ShaderMaterial({fragmentShader:c.fragmentShader,vertexShader:c.vertexShader,uniforms:c.uniforms,side:THREE.BackSide}))),this.add(new INTERACTIVEWORLD.House)},INTERACTIVEWORLD.World.prototype.__proto__=THREE.Object3D.prototype;