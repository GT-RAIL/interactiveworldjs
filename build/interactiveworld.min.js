var INTERACTIVEWORLD=INTERACTIVEWORLD||{REVISION:"1-devel"};INTERACTIVEWORLD.BRICKS_TEXTURE="resources/textures/bricks.jpg",INTERACTIVEWORLD.CARDBOARD_CORRUGATED_TEXTURE="resources/textures/cardboard-corrugated.jpg",INTERACTIVEWORLD.CARDBOARD_TEXTURE="resources/textures/cardboard.jpg",INTERACTIVEWORLD.CARPET_GREY_TEXTURE="resources/textures/carpet-grey.jpg",INTERACTIVEWORLD.CARPET_PATTERN_TEXTURE="resources/textures/carpet-pattern.jpg",INTERACTIVEWORLD.CARPET_TAN_TEXTURE="resources/textures/carpet-tan.jpg",INTERACTIVEWORLD.CHINA_TEXTURE="resources/textures/china.jpg",INTERACTIVEWORLD.COUNTERTOP_BLACK_TEXTURE="resources/textures/countertop-black.jpg",INTERACTIVEWORLD.COUNTERTOP_RED_TEXTURE="resources/textures/countertop-red.jpg",INTERACTIVEWORLD.FABRIC_AQUA_TEXTURE="resources/textures/fabric-aqua.jpg",INTERACTIVEWORLD.FABRIC_RED_TEXTURE="resources/textures/fabric-red.jpg",INTERACTIVEWORLD.GLASS_TEXTURE="resources/textures/glass.jpg",INTERACTIVEWORLD.GRASS_TEXTURE="resources/textures/grass.jpg",INTERACTIVEWORLD.HARDWOOD_DARK_TEXTURE="resources/textures/hardwood-dark.jpg",INTERACTIVEWORLD.HARDWOOD_LIGHT_TEXTURE="resources/textures/hardwood-light.jpg",INTERACTIVEWORLD.METAL_VERTICAL_TEXTURE="resources/textures/metal-vertical.jpg",INTERACTIVEWORLD.NEWSPAPER_TEXTURE="resources/textures/newspaper.jpg",INTERACTIVEWORLD.NIGHTSTAND_TEXTURE="resources/textures/nightstand.jpg",INTERACTIVEWORLD.PAINTED_WALL_BLUE_TEXTURE="resources/textures/painted-wall-blue.jpg",INTERACTIVEWORLD.PAINTED_WALL_RED_TEXTURE="resources/textures/painted-wall-red.jpg",INTERACTIVEWORLD.PARTICLE_BOARD_TEXTURE="resources/textures/particle-board.jpg",INTERACTIVEWORLD.PLASTIC_BLACK_TEXTURE="resources/textures/plastic-black.jpg",INTERACTIVEWORLD.RUG_TEXTURE="resources/textures/rug.jpg",INTERACTIVEWORLD.SKY_TEXTURE="resources/textures/sky.jpg",INTERACTIVEWORLD.TILE_FLOOR_TEXTURE="resources/textures/tile-floor.jpg",INTERACTIVEWORLD.TILE_WALL_TEXTURE="resources/textures/tile-wall.jpg",INTERACTIVEWORLD.WALLPAPER_DARK_TEXTURE="resources/textures/wallpaper-dark.jpg",INTERACTIVEWORLD.WALLPAPER_LIGHT_TEXTURE="resources/textures/wallpaper-light.jpg",INTERACTIVEWORLD.WALLPAPER_RED_DOTS_TEXTURE="resources/textures/wallpaper-red-dots.jpg",INTERACTIVEWORLD.WOOD_CHERRY_TEXTURE="resources/textures/wood-cherry.jpg",INTERACTIVEWORLD.WOOD_MAHOGANY_POLISHED_TEXTURE="resources/textures/wood-mahogany-polished.jpg",INTERACTIVEWORLD.WOOD_MAHOGANY_TEXTURE="resources/textures/wood-mahogany.jpg",INTERACTIVEWORLD.WOOD_OAK_HORIZONTAL_TEXTURE="resources/textures/wood-oak-horizontal.jpg",INTERACTIVEWORLD.WOOD_OACK_VERTICAL_TEXTURE="resources/textures/wood-oak-vertical.jpg",INTERACTIVEWORLD.WOOD_PINE_TEXTURE="resources/textures/wood-pine.jpg",INTERACTIVEWORLD.NEXT_ARROW="resources/images/next.png",INTERACTIVEWORLD.PREVIOUS_ARROW="resources/images/previous.png",INTERACTIVEWORLD.Z_INDEX=.005,INTERACTIVEWORLD.NORTH_WALL=0,INTERACTIVEWORLD.EAST_WALL=1,INTERACTIVEWORLD.SOUTH_WALL=2,INTERACTIVEWORLD.WEST_WALL=3,INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE=0,INTERACTIVEWORLD.POSITIVE_DOOR_SIDE=1,INTERACTIVEWORLD.INTERACTION_SURFACE_THICKNESS=.05,INTERACTIVEWORLD.OBJECT_MENU_DISPLAY_WIDTH=3,INTERACTIVEWORLD.OBJECT_MENU_DISPLAY_HEIGHT=3,INTERACTIVEWORLD.OBJECT_MENU_DISPLAY_FLOOR_TEXTURE=INTERACTIVEWORLD.WOOD_MAHOGANY_POLISHED_TEXTURE,INTERACTIVEWORLD.WORLD_WIDTH=20,INTERACTIVEWORLD.WORLD_HEIGHT=20,INTERACTIVEWORLD.WORLD_FLOOR_TEXTURE=INTERACTIVEWORLD.GRASS_TEXTURE,INTERACTIVEWORLD.WALL_WIDTH=.05,INTERACTIVEWORLD.WALL_HEIGHT=.75,INTERACTIVEWORLD.DOOR_WIDTH=.8,INTERACTIVEWORLD.HALLWAY_WIDTH=1,INTERACTIVEWORLD.ROOM_WIDTH=4.9,INTERACTIVEWORLD.ROOM_HEIGHT=4,INTERACTIVEWORLD.HOUSE_WIDTH=2*INTERACTIVEWORLD.ROOM_WIDTH+INTERACTIVEWORLD.HALLWAY_WIDTH,INTERACTIVEWORLD.HOUSE_HEIGHT=2*INTERACTIVEWORLD.ROOM_HEIGHT+INTERACTIVEWORLD.HALLWAY_WIDTH,INTERACTIVEWORLD.HOUSE_WALL_TEXTURE=INTERACTIVEWORLD.BRICKS_TEXTURE,INTERACTIVEWORLD.HOUSE_FLOOR_TEXTURE=INTERACTIVEWORLD.HARDWOOD_LIGHT_TEXTURE,INTERACTIVEWORLD.BEDROOM_WALL_TEXTURE=INTERACTIVEWORLD.PAINTED_WALL_BLUE_TEXTURE,INTERACTIVEWORLD.BEDROOM_FLOOR_TEXTURE=INTERACTIVEWORLD.CARPET_GREY_TEXTURE,INTERACTIVEWORLD.KITCHEN_WALL_TEXTURE=INTERACTIVEWORLD.TILE_WALL_TEXTURE,INTERACTIVEWORLD.KITCHEN_FLOOR_TEXTURE=INTERACTIVEWORLD.TILE_FLOOR_TEXTURE,INTERACTIVEWORLD.DINING_ROOM_WALL_TEXTURE=INTERACTIVEWORLD.WALLPAPER_LIGHT_TEXTURE,INTERACTIVEWORLD.DINING_ROOM_FLOOR_TEXTURE=INTERACTIVEWORLD.HARDWOOD_DARK_TEXTURE,INTERACTIVEWORLD.LIVING_ROOM_WALL_TEXTURE=INTERACTIVEWORLD.PAINTED_WALL_RED_TEXTURE,INTERACTIVEWORLD.LIVING_ROOM_FLOOR_TEXTURE=INTERACTIVEWORLD.CARPET_TAN_TEXTURE,INTERACTIVEWORLD.BED_MODEL="resources/models/bed.min.dae",INTERACTIVEWORLD.DRESSER_MODEL="resources/models/dresser.min.dae",INTERACTIVEWORLD.NIGHTSTAND_MODEL="resources/models/nightstand.min.dae",INTERACTIVEWORLD.DINING_TABLE_MODEL="resources/models/dining-table.min.dae",INTERACTIVEWORLD.SINK_MODEL="resources/models/sink.min.dae",INTERACTIVEWORLD.CABINET_MODEL="resources/models/cabinet.min.dae",INTERACTIVEWORLD.REFRIGERATOR_MODEL="resources/models/refrigerator.min.dae",INTERACTIVEWORLD.OVEN_MODEL="resources/models/oven.min.dae",INTERACTIVEWORLD.COUNTER_MODEL="resources/models/counter.min.dae",INTERACTIVEWORLD.COUCH_MODEL="resources/models/couch.min.dae",INTERACTIVEWORLD.TV_MODEL="resources/models/tv.min.dae",INTERACTIVEWORLD.COFFEE_TABLE_MODEL="resources/models/coffee-table.min.dae",INTERACTIVEWORLD.PLATE_MODEL="resources/models/plate.min.dae",INTERACTIVEWORLD.SPOON_MODEL="resources/models/spoon.min.dae",INTERACTIVEWORLD.MAGAZINES_MODEL="resources/models/magazines.min.dae",INTERACTIVEWORLD.CUP_MODEL="resources/models/cup.min.dae",INTERACTIVEWORLD.FORK_MODEL="resources/models/fork.min.dae",INTERACTIVEWORLD.DIV_ID="interactive-world",INTERACTIVEWORLD.init=function(){document.body.innerHTML="";var a=document.createElement("div");a.id=INTERACTIVEWORLD.DIV_ID,document.getElementsByTagName("body")[0].appendChild(a);var b=new INTERACTIVEWORLD.Viewer({divID:INTERACTIVEWORLD.DIV_ID,antialias:!0});return b},INTERACTIVEWORLD.InteractionHandler=function(){},INTERACTIVEWORLD.InteractionHandler.prototype.__proto__=EventEmitter2.prototype,INTERACTIVEWORLD.InteractionSurface=function(a){a=a||{},this.width=a.width,this.height=a.height,this.displayObject=null,this.eventHandler=new INTERACTIVEWORLD.InteractionHandler;var b=new THREE.CubeGeometry(this.width,this.height,INTERACTIVEWORLD.INTERACTION_SURFACE_THICKNESS),c=new THREE.MeshLambertMaterial({transparent:!0,color:65280});c.opacity=0,THREE.Mesh.call(this,b,c),this.position.z=INTERACTIVEWORLD.INTERACTION_SURFACE_THICKNESS},INTERACTIVEWORLD.InteractionSurface.prototype.__proto__=THREE.Mesh.prototype,INTERACTIVEWORLD.InteractionSurface.prototype.mousemove=function(a,b){this.material.opacity=.5,this.parent.updateMatrixWorld();var c=new THREE.Vector3;c.getPositionFromMatrix(this.matrixWorld),null===this.displayObject&&(this.displayObject=new a,this.add(this.displayObject)),this.setObjectPose(this.displayObject,b)},INTERACTIVEWORLD.InteractionSurface.prototype.mouseout=function(){this.material.opacity=0,null!==this.displayObject&&(this.remove(this.displayObject),this.displayObject=null)},INTERACTIVEWORLD.InteractionSurface.prototype.dblclick=function(a,b){var c=this,d=new a;this.setObjectPose(d,b),this.eventHandler.emit("addition",{name:"surface",position:{x:c.position.x,y:c.position.y,z:c.position.z},rotation:{x:c.rotation.x,y:c.rotation.y,z:c.rotation.z},object:{name:d.name,position:{x:d.position.x,y:d.position.y,z:d.position.z},rotation:{x:d.rotation.x,y:d.rotation.y,z:d.rotation.z}}}),this.add(d)},INTERACTIVEWORLD.InteractionSurface.prototype.setObjectPose=function(a,b){this.parent.updateMatrixWorld();var c=new THREE.Vector3;if(c.getPositionFromMatrix(this.matrixWorld),a.position=b.sub(c),this.parent.rotation.z===Math.PI||this.parent.rotation.z===-Math.PI)a.position.x*=-1,a.position.y*=-1;else if(this.parent.rotation.z===Math.PI/2){var d=-a.position.x;a.position.x=a.position.y,a.position.y=d}else if(this.parent.rotation.z===-Math.PI/2){var e=a.position.x;a.position.x=-a.position.y,a.position.y=e}a.rotation.z=Math.abs(a.position.x)/this.width>Math.abs(a.position.y)/this.height?a.position.x>0?Math.PI/2:-Math.PI/2:a.position.y>0?Math.PI:0},INTERACTIVEWORLD.MouseControls=function(a){function b(a){switch(a.preventDefault(),a.button){case 0:o=n.PAN,l.set(a.clientX,a.clientY);break;case 2:o=n.ROTATE,k.set(a.clientX,a.clientY)}h.domElement.addEventListener("mousemove",c,!1),h.domElement.addEventListener("mouseup",d,!1)}function c(a){a.preventDefault();var b=a.movementX||a.mozMovementX||a.webkitMovementX||0,c=a.movementY||a.mozMovementY||a.webkitMovementY||0;switch(o){case n.ROTATE:j.position.x=j.position.x,j.position.y=j.position.y,j.rotation.z-=.002*(b-c);break;case n.PAN:j.translateX(.01*-b),j.translateY(.01*c),j.position.x=Math.min(Math.max(j.position.x,-INTERACTIVEWORLD.HOUSE_WIDTH/2),INTERACTIVEWORLD.HOUSE_WIDTH/2),j.position.y=Math.min(Math.max(j.position.y,-INTERACTIVEWORLD.HOUSE_HEIGHT/2),INTERACTIVEWORLD.HOUSE_HEIGHT/2)}}function d(a){a.preventDefault(),h.domElement.removeEventListener("mousemove",c,!1),h.domElement.removeEventListener("mouseup",d,!1),o=n.NONE}function e(a){a.preventDefault();var b=0;a.wheelDelta?b=a.wheelDelta:a.detail&&(b=-a.detail),b>0?h.dollyOut():h.dollyIn()}function f(a){a.preventDefault();var b=new THREE.Vector3(2*(a.clientX/window.innerWidth)-1,2*-(a.clientY/window.innerHeight)+1,.5);m.unprojectVector(b,h.camera),h.camera.updateMatrixWorld();var c=new THREE.Vector3;c.getPositionFromMatrix(h.camera.matrixWorld);for(var d=new THREE.Raycaster(c,b.sub(c).normalize()),e=d.intersectObjects(h.surfaces),f=0;f<h.surfaces.length;f++)e.length>0&&e[0].object===h.surfaces[f]?h.surfaces[f].mousemove(i.getDisplayObjectType(),e[0].point):h.surfaces[f].mouseout()}function g(a){a.preventDefault();var b=new THREE.Vector3(2*(a.clientX/window.innerWidth)-1,2*-(a.clientY/window.innerHeight)+1,.5);m.unprojectVector(b,h.camera),h.camera.updateMatrixWorld();var c=new THREE.Vector3;c.getPositionFromMatrix(h.camera.matrixWorld);var d=new THREE.Raycaster(c,b.sub(c).normalize()),e=d.intersectObjects(h.surfaces);e.length>0&&(e[0].object.dblclick(i.getDisplayObjectType(),e[0].point),i.markPlacedItem())}var h=this;a=a||{},this.camera=a.camera,this.scene=a.scene,this.domElement=a.domElement;var i=a.objectMenu;this.surfaces=[],this.camera.position.z=4*INTERACTIVEWORLD.WALL_HEIGHT;var j=new THREE.Object3D;j.add(this.camera),this.scene.add(j),j.position.z=3*INTERACTIVEWORLD.WALL_HEIGHT,this.target=new THREE.Vector3,this.EPS=1e-6,this.phiDelta=0,this.thetaDelta=0,this.scale=1,this.pan=new THREE.Vector3,this.zoomSpeed=1,this.autoRotateSpeed=2;var k=new THREE.Vector2,l=new THREE.Vector2;this.lastPosition=new THREE.Vector3;var m=new THREE.Projector,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2},o=n.NONE;this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",b,!1),this.domElement.addEventListener("mousewheel",e,!1),this.domElement.addEventListener("DOMMouseScroll",e,!1),this.domElement.addEventListener("mousemove",f,!1),this.domElement.addEventListener("dblclick",g,!1),this.rotateUp(-.75)},INTERACTIVEWORLD.MouseControls.prototype.__proto__=THREE.EventDispatcher.prototype,INTERACTIVEWORLD.MouseControls.prototype.update=function(){var a=this.camera.position,b=a.clone().sub(this.target),c=Math.atan2(Math.sqrt(b.x*b.x+b.z*b.z),b.y)+this.phiDelta;c=Math.max(0,Math.min(Math.PI,c)),c=Math.max(this.EPS,Math.min(Math.PI-this.EPS,c));var d=b.length()*this.scale;4>d&&d>.5&&(b.y=d*Math.cos(c),b.z=d*Math.sin(c),a.copy(this.target).add(b),this.camera.lookAt(this.target)),this.phiDelta=0,this.scale=1},INTERACTIVEWORLD.MouseControls.prototype.rotateUp=function(a){void 0===a&&(a=2*Math.PI/60/60*this.autoRotateSpeed),this.phiDelta-=a},INTERACTIVEWORLD.MouseControls.prototype.dollyIn=function(a){void 0===a&&(a=Math.pow(.95,this.zoomSpeed)),this.scale/=a,this.rotateUp(.01)},INTERACTIVEWORLD.MouseControls.prototype.dollyOut=function(a){void 0===a&&(a=Math.pow(.95,this.zoomSpeed)),this.scale*=a,this.rotateUp(-.01)},INTERACTIVEWORLD.MouseControls.prototype.addInteractionSurfaces=function(a){for(var b=0;b<a.length;b++)this.surfaces.push(a[b])},INTERACTIVEWORLD.ObjectMenu=function(a){function b(){i--,0>i&&(i=h.length-1),n.remove(f.displayObject),f.displayObject=h[i],n.add(f.displayObject),s.innerHTML="&nbsp;&nbsp;&nbsp;"+f.displayObject.name+"&nbsp;&nbsp;&nbsp;"}function c(){i++,i>=h.length&&(i=0),n.remove(f.displayObject),f.displayObject=h[i],n.add(f.displayObject),s.innerHTML="&nbsp;&nbsp;&nbsp;"+f.displayObject.name+"&nbsp;&nbsp;&nbsp;"}function d(){var a=f.getMenuWidth(),b=f.getMenuHeight();k.style.width=a+"px",k.style.height=b+"px",k.style.top=window.innerHeight-b+"px",l.style.fontSize=Math.round(f.getMenuWidth()/20)+"px",r.style.height=Math.round(f.getMenuWidth()/12)+"px",t.style.height=Math.round(f.getMenuWidth()/12)+"px",q.style.height=Math.round(f.getMenuWidth()/12)+"px",m.setSize(a,b-l.offsetHeight-q.offsetHeight),o.aspect=a/(b-l.offsetHeight-q.offsetHeight)}function e(){f.displayObject.rotation.z+=.005,m.render(n,o),requestAnimationFrame(e)}var f=this;a=a||{};var g=a.antialias,h=a.objects,i=0;this.displayObject=h[i],this.placedObjects=[],this.placedObjectCount=[],this.numObjects=h.length,this.allObjects=h;var j=a.title||"";this.completion=a.completion||1;var k=document.createElement("div");k.classList.add("object-menu"),document.getElementsByTagName("body")[0].appendChild(k);var l=document.createElement("h1");l.innerHTML=j,k.appendChild(l);var m=new THREE.WebGLRenderer({antialias:g}),n=new THREE.Scene;n.add(this.displayObject);var o=new THREE.PerspectiveCamera(60,2.5,.01,1e3);o.position.y=-.25,o.position.z=.25,o.lookAt(n.position);var p=new THREE.Mesh(new THREE.CubeGeometry(INTERACTIVEWORLD.OBJECT_MENU_DISPLAY_WIDTH,INTERACTIVEWORLD.OBJECT_MENU_DISPLAY_HEIGHT,.01),new THREE.MeshLambertMaterial({transparent:!0,color:255}));p.material.opacity=.5,p.position.z=-.01,n.add(p),n.add(new THREE.AmbientLight(6710886)),n.add(new THREE.HemisphereLight(16777215,11184810,.8)),k.appendChild(m.domElement);var q=document.createElement("div"),r=document.createElement("img");r.src=INTERACTIVEWORLD.PREVIOUS_ARROW,r.onclick=b,r.style.cursor="pointer",q.appendChild(r);var s=document.createElement("span");q.appendChild(s),s.innerHTML="&nbsp;&nbsp;&nbsp;"+this.displayObject.name+"&nbsp;&nbsp;&nbsp;";var t=document.createElement("img");t.src=INTERACTIVEWORLD.NEXT_ARROW,t.onclick=c,t.style.cursor="pointer",q.appendChild(t),k.appendChild(q),window.addEventListener("resize",d,!1),d(),e()},INTERACTIVEWORLD.ObjectMenu.prototype.__proto__=EventEmitter2.prototype,INTERACTIVEWORLD.ObjectMenu.prototype.getMenuWidth=function(){return window.innerWidth/4},INTERACTIVEWORLD.ObjectMenu.prototype.getMenuHeight=function(){return.5*this.getMenuWidth()},INTERACTIVEWORLD.ObjectMenu.prototype.getDisplayObjectType=function(){return this.displayObject.constructor},INTERACTIVEWORLD.ObjectMenu.prototype.markPlacedItem=function(){var a=this.allObjects.indexOf(this.displayObject);if(-1===this.placedObjects.indexOf(a)?(this.placedObjects.push(a),this.placedObjectCount.push(1)):this.placedObjectCount[this.placedObjects.indexOf(a)]++,this.placedObjects.length===this.numObjects){for(var b=0;b<this.numObjects;b++)if(this.placedObjectCount[b]<this.completion)return;this.emit("completion")}},INTERACTIVEWORLD.Bed=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Bed",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.BED_MODEL,function(b){b.scene.position.x=-.04,b.scene.position.y=2.17,b.scene.rotation.z=-Math.PI/2,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:1.65,height:2.05});c.position.x=.825,c.position.y=1.025,c.position.z=.64,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c)},INTERACTIVEWORLD.Bed.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Cabinet=function(){var a=this;THREE.Object3D.call(this),this.name="Cabinet";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.CABINET_MODEL,function(b){b.scene.position.y=.1,a.add(b.scene)})},INTERACTIVEWORLD.Cabinet.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.CoffeeTable=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Coffee Table",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.COFFEE_TABLE_MODEL,function(b){b.scene.position.y=.75,b.scene.rotation.z=-Math.PI/2,b.scene.scale.x*=.11,b.scene.scale.y*=.11,b.scene.scale.z*=.11,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:1.5,height:.81});c.position.x=.78,c.position.y=.4,c.position.z=.4,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c)},INTERACTIVEWORLD.CoffeeTable.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Couch=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Couch",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.COUCH_MODEL,function(b){b.scene.position.x=-.7,b.scene.position.y=.55,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:1,height:1.5});c.position.x=.5,c.position.y=.8,c.position.z=.35,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c);var d=new INTERACTIVEWORLD.InteractionSurface({width:1.85,height:.9});d.position.x=1.85,d.position.y=1.2,d.position.z=.35,d.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(d),this.interactions.push(d)},INTERACTIVEWORLD.Couch.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Counter=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Counter",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.COUNTER_MODEL,function(b){b.scene.position.x=1.65,b.scene.position.y=1.95,b.scene.scale.x*=.85,b.scene.scale.y*=.85,b.scene.scale.z*=.85,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:1.1,height:.8});c.position.x=.53,c.position.y=.43,c.position.z=.78,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c)},INTERACTIVEWORLD.Counter.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Cup=function(){var a=this;THREE.Object3D.call(this),this.name="Cup";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.CUP_MODEL,function(b){b.scene.scale.x*=.04,b.scene.scale.y*=.04,b.scene.scale.z*=.04,a.add(b.scene)})},INTERACTIVEWORLD.Cup.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.DiningTable=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Dining Table",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.DINING_TABLE_MODEL,function(b){b.scene.position.x=2.4,b.scene.position.y=1.75,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:2.4,height:1.2});c.position.x=1.425,c.position.y=.85,c.position.z=.7,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c)},INTERACTIVEWORLD.DiningTable.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Dresser=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Dresser",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.DRESSER_MODEL,function(b){b.scene.position.x=-17.32,b.scene.position.y=-11.55,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:1.36,height:.48});c.position.x=.66,c.position.y=.23,c.position.z=.8,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c)},INTERACTIVEWORLD.Dresser.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Fork=function(){var a=this;THREE.Object3D.call(this),this.name="Fork";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.FORK_MODEL,function(b){b.scene.scale.x*=.95,b.scene.scale.y*=.95,b.scene.scale.z*=.95,b.scene.position.x=-.01,b.scene.position.y=.05,b.scene.rotation.z=Math.PI/2,a.add(b.scene)})},INTERACTIVEWORLD.Fork.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Magazines=function(){var a=this;THREE.Object3D.call(this),this.name="Magazines";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.MAGAZINES_MODEL,function(b){b.scene.position.x=-.1,b.scene.position.y=-.1,b.scene.scale.x*=.4,b.scene.scale.y*=.4,b.scene.scale.z*=.4,a.add(b.scene)})},INTERACTIVEWORLD.Magazines.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Nightstand=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Nightstand",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.NIGHTSTAND_MODEL,function(b){b.scene.position.x=-.95,b.scene.position.y=-.69,b.scene.position.z=-.1,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:.88,height:.6});c.position.x=.42,c.position.y=.3,c.position.z=.75,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c)},INTERACTIVEWORLD.Nightstand.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Oven=function(){var a=this;THREE.Object3D.call(this),this.name="Oven";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.OVEN_MODEL,function(b){b.scene.position.x=-.45,b.scene.position.y=-.2,a.add(b.scene)})},INTERACTIVEWORLD.Oven.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Plate=function(){var a=this;THREE.Object3D.call(this),this.name="Plate";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.PLATE_MODEL,function(b){b.scene.position.x=-.1,b.scene.position.y=-.07,b.scene.scale.x*=.04,b.scene.scale.y*=.04,b.scene.scale.z*=.04,a.add(b.scene)})},INTERACTIVEWORLD.Plate.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Refrigerator=function(){var a=this;THREE.Object3D.call(this),this.name="Refrigerator";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.REFRIGERATOR_MODEL,function(b){b.scene.position.x=-.15,b.scene.position.y=1.15,b.scene.rotation.z=-Math.PI/2,a.add(b.scene)})},INTERACTIVEWORLD.Refrigerator.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Sink=function(){var a=this;THREE.Object3D.call(this),this.eventHandler=new INTERACTIVEWORLD.InteractionHandler,this.name="Sink",this.interactions=[];var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.SINK_MODEL,function(b){b.scene.position.x=-.3,b.scene.position.y=-.2,a.add(b.scene)});var c=new INTERACTIVEWORLD.InteractionSurface({width:.8,height:.46});c.position.x=1.95,c.position.y=.33,c.position.z=.6,c.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(c),this.interactions.push(c);var d=new INTERACTIVEWORLD.InteractionSurface({width:1.5,height:.8});d.position.x=.75,d.position.y=.45,d.position.z=.9,d.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(d),this.interactions.push(d);var e=new INTERACTIVEWORLD.InteractionSurface({width:.5,height:.8});e.position.x=2.65,e.position.y=.45,e.position.z=.9,e.eventHandler.on("addition",function(b){a.eventHandler.emit("addition",{name:a.name,position:{x:a.position.x,y:a.position.y,z:a.position.z},rotation:{x:a.rotation.x,y:a.rotation.y,z:a.rotation.z},surface:b})}),this.add(e),this.interactions.push(e)},INTERACTIVEWORLD.Sink.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Spoon=function(){var a=this;THREE.Object3D.call(this),this.name="Spoon";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.SPOON_MODEL,function(b){b.scene.position.x=.019,b.scene.position.y=-.06,b.scene.rotation.z=Math.PI/2,a.add(b.scene)})},INTERACTIVEWORLD.Spoon.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.TV=function(){var a=this;THREE.Object3D.call(this),this.name="TV";var b=new THREE.ColladaLoader;b.load(INTERACTIVEWORLD.TV_MODEL,function(b){b.scene.position.x=1.3,b.scene.position.y=.6,b.scene.scale.x*=.66,b.scene.scale.y*=.66,b.scene.scale.z*=.66,a.add(b.scene)})},INTERACTIVEWORLD.TV.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.TexturePlane=function(a){a=a||{};var b=a.width,c=a.height,d=a.texture,e=a.repeat;this.name="Plane";var f=new THREE.ImageUtils.loadTexture(d);f.wrapS=f.wrapT=THREE.RepeatWrapping,f.repeat.set(e,e),THREE.Mesh.call(this,new THREE.PlaneGeometry(b,c),new THREE.MeshLambertMaterial({map:f}))},INTERACTIVEWORLD.TexturePlane.prototype.__proto__=THREE.Mesh.prototype,INTERACTIVEWORLD.Wall=function(a){a=a||{};var b=a.length,c=a.texture;this.name="Wall";var d=new THREE.ImageUtils.loadTexture(c);d.wrapS=d.wrapT=THREE.RepeatWrapping,d.repeat.set(b,1),THREE.Mesh.call(this,new THREE.CubeGeometry(b,INTERACTIVEWORLD.WALL_WIDTH,INTERACTIVEWORLD.WALL_HEIGHT),new THREE.MeshLambertMaterial({map:d,side:THREE.DoubleSide})),this.position.z=INTERACTIVEWORLD.WALL_HEIGHT/2},INTERACTIVEWORLD.Wall.prototype.__proto__=THREE.Mesh.prototype,INTERACTIVEWORLD.Bedroom=function(a){var b=this;a=a||[],THREE.Object3D.call(this),this.name="Bedroom",this.eventHandler=new INTERACTIVEWORLD.InteractionHandler;var c=a.controls,d=a.setup||Math.floor(2*Math.random());this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.BEDROOM_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.BEDROOM_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.EAST_WALL,doorSide:INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE}));var e=new INTERACTIVEWORLD.Bed;e.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})});var f=new INTERACTIVEWORLD.Nightstand;f.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})});var g=new INTERACTIVEWORLD.Nightstand;g.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})});var h=new INTERACTIVEWORLD.Dresser;h.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})}),0===d?(e.position.x=-.8,e.position.y=-.2,f.position.x=1.25,f.position.y=1.3,g.position.x=-2,g.position.y=1.3,h.position.x=.645,h.position.y=-1.45,h.rotation.z=Math.PI):1===d&&(e.position.x=-.2,e.position.y=0,e.rotation.z=Math.PI/2,f.position.x=1,f.position.y=-1.3,f.rotation.z=Math.PI,g.position.x=1.75,g.position.y=.9,g.rotation.z=-Math.PI/2,h.position.x=-1.95,h.position.y=-1.55,h.rotation.z=Math.PI/2),this.add(e),this.add(f),this.add(g),this.add(h),c.addInteractionSurfaces(e.interactions),c.addInteractionSurfaces(f.interactions),c.addInteractionSurfaces(g.interactions),c.addInteractionSurfaces(h.interactions)},INTERACTIVEWORLD.Bedroom.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.DiningRoom=function(a){var b=this;a=a||[],THREE.Object3D.call(this),this.name="Dining Room",this.eventHandler=new INTERACTIVEWORLD.InteractionHandler;var c=a.controls,d=a.setup||Math.floor(2*Math.random());this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.DINING_ROOM_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.DINING_ROOM_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.NORTH_WALL,doorSide:INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE}));var e=new INTERACTIVEWORLD.DiningTable;e.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})});var f=new INTERACTIVEWORLD.Cabinet,g=new INTERACTIVEWORLD.TexturePlane({width:3.2,height:2,texture:INTERACTIVEWORLD.RUG_TEXTURE,repeat:1});0===d?(e.position.x=-1.2,e.position.y=-.3,f.position.x=-.55,f.position.y=-1.4,f.rotation.z=Math.PI,g.position.x=.3,g.position.y=.6,g.position.z=3*INTERACTIVEWORLD.Z_INDEX):1===d&&(e.position.x=-.1,e.position.y=-1.6,e.rotation.z=Math.PI/2,f.position.x=.55,f.position.y=1.4,g.position.x=-.9,g.position.y=-.2,g.position.z=3*INTERACTIVEWORLD.Z_INDEX,g.rotation.z=Math.PI/2),this.add(e),this.add(f),this.add(g),c.addInteractionSurfaces(e.interactions)},INTERACTIVEWORLD.DiningRoom.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.House=function(a){var b=this;a=a||[],THREE.Object3D.call(this);var c=a.controls;this.eventHandler=new INTERACTIVEWORLD.InteractionHandler;var d=new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.HOUSE_WIDTH,height:INTERACTIVEWORLD.HOUSE_HEIGHT,floor:INTERACTIVEWORLD.HOUSE_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.HOUSE_WALL_TEXTURE});d.position.z=-INTERACTIVEWORLD.Z_INDEX,this.add(d);var e=INTERACTIVEWORLD.WALL_WIDTH/2,f=new INTERACTIVEWORLD.Bedroom({controls:c});f.position.x=-(INTERACTIVEWORLD.ROOM_WIDTH/2)-(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)+e,f.position.y=INTERACTIVEWORLD.ROOM_HEIGHT/2+(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)-e,f.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",a)}),this.add(f);var g=new INTERACTIVEWORLD.Kitchen({controls:c});g.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",a)}),g.position.x=INTERACTIVEWORLD.ROOM_WIDTH/2+(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)-e,g.position.y=INTERACTIVEWORLD.ROOM_HEIGHT/2+(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)-e,this.add(g);var h=new INTERACTIVEWORLD.LivingRoom({controls:c});h.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",a)}),h.position.x=-(INTERACTIVEWORLD.ROOM_WIDTH/2)-(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)+e,h.position.y=-(INTERACTIVEWORLD.ROOM_HEIGHT/2)-(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)+e,this.add(h);var i=new INTERACTIVEWORLD.DiningRoom({controls:c});i.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",a)}),i.position.x=INTERACTIVEWORLD.ROOM_WIDTH/2+(INTERACTIVEWORLD.HOUSE_WIDTH/2-INTERACTIVEWORLD.ROOM_WIDTH)-e,i.position.y=-(INTERACTIVEWORLD.ROOM_HEIGHT/2)-(INTERACTIVEWORLD.HOUSE_HEIGHT/2-INTERACTIVEWORLD.ROOM_HEIGHT)+e,this.add(i)
},INTERACTIVEWORLD.House.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Kitchen=function(a){var b=this;a=a||[],THREE.Object3D.call(this),this.name="Kitchen",this.eventHandler=new INTERACTIVEWORLD.InteractionHandler;var c=a.controls,d=a.setup||Math.floor(2*Math.random());this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.KITCHEN_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.KITCHEN_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.SOUTH_WALL,doorSide:INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE}));var e=new INTERACTIVEWORLD.Refrigerator,f=new INTERACTIVEWORLD.Sink;f.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})});var g=new INTERACTIVEWORLD.Oven,h=new INTERACTIVEWORLD.Counter;h.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})});var i=new INTERACTIVEWORLD.Counter;i.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})}),0===d?(e.position.x=1.2,e.position.y=1.1,f.position.x=-2.2,f.position.y=1.1,g.position.x=1,g.position.y=-1.35,g.rotation.z=Math.PI,h.position.x=2.1,h.position.y=-1.1,h.rotation.z=Math.PI,i.position.x=-.3,i.position.y=-1.1,i.rotation.z=Math.PI):1===d&&(e.position.x=2.3,e.position.y=-1.2,e.rotation.z=Math.PI,f.position.x=-1.6,f.position.y=-.95,f.rotation.z=Math.PI/2,g.position.x=1,g.position.y=-1.35,g.rotation.z=Math.PI,h.position.x=1.3,h.position.y=1.1,i.position.x=.25,i.position.y=1.1),this.add(e),this.add(f),this.add(g),this.add(h),this.add(i),c.addInteractionSurfaces(f.interactions),c.addInteractionSurfaces(h.interactions),c.addInteractionSurfaces(i.interactions)},INTERACTIVEWORLD.Kitchen.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.LivingRoom=function(a){var b=this;a=a||[],THREE.Object3D.call(this),this.name="Living Room",this.eventHandler=new INTERACTIVEWORLD.InteractionHandler;var c=a.controls,d=a.setup||Math.floor(2*Math.random());this.add(new INTERACTIVEWORLD.Room({width:INTERACTIVEWORLD.ROOM_WIDTH,height:INTERACTIVEWORLD.ROOM_HEIGHT,floor:INTERACTIVEWORLD.LIVING_ROOM_FLOOR_TEXTURE,wall:INTERACTIVEWORLD.LIVING_ROOM_WALL_TEXTURE,withDoor:!0,doorWall:INTERACTIVEWORLD.EAST_WALL,doorSide:INTERACTIVEWORLD.POSITIVE_DOOR_SIDE}));var e=new INTERACTIVEWORLD.Couch;e.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})});var f=new INTERACTIVEWORLD.TV,g=new INTERACTIVEWORLD.CoffeeTable;g.eventHandler.on("addition",function(a){b.eventHandler.emit("addition",{name:b.name,position:{x:b.position.x,y:b.position.y,z:b.position.z},rotation:{x:b.rotation.x,y:b.rotation.y,z:b.rotation.z},furniture:a})}),0===d?(e.position.x=-.65,e.position.y=-1.95,e.rotation.z=Math.PI/2,f.position.x=1.7,f.position.y=.5,f.rotation.z=-Math.PI/2,g.position.x=-.15,g.position.y=.7,g.rotation.z=-Math.PI/2):1===d&&(e.position.x=2.35,e.position.y=-.2,e.rotation.z=Math.PI,f.position.x=-.5,f.position.y=1.3,g.position.x=-.5,g.position.y=0),this.add(e),this.add(f),this.add(g),c.addInteractionSurfaces(g.interactions),c.addInteractionSurfaces(e.interactions)},INTERACTIVEWORLD.LivingRoom.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Room=function(a){THREE.Object3D.call(this),a=a||{};var b=a.width,c=a.height,d=a.withDoor,e=a.doorWall,f=a.doorSide,g=a.floor,h=a.wall;this.add(new INTERACTIVEWORLD.TexturePlane({width:b,height:c,texture:g,repeat:4}));var i=new INTERACTIVEWORLD.Wall({length:b,texture:h});i.position.y=c/2;var j=new INTERACTIVEWORLD.Wall({length:c,texture:h});j.position.x=b/2,j.rotation.z=Math.PI/2;var k=new INTERACTIVEWORLD.Wall({length:b,texture:h});k.position.y=-c/2;var l=new INTERACTIVEWORLD.Wall({length:c,texture:h});l.position.x=-b/2,l.rotation.z=Math.PI/2,d&&(e===INTERACTIVEWORLD.NORTH_WALL?(i=new INTERACTIVEWORLD.Wall({length:b-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),i.position.y=c/2,i.position.x=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2):e===INTERACTIVEWORLD.EAST_WALL?(j=new INTERACTIVEWORLD.Wall({length:c-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),j.position.x=b/2,j.rotation.z=Math.PI/2,j.position.y=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2):e===INTERACTIVEWORLD.SOUTH_WALL?(k=new INTERACTIVEWORLD.Wall({length:b-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),k.position.y=-c/2,k.position.x=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2):(l=new INTERACTIVEWORLD.Wall({length:c-INTERACTIVEWORLD.DOOR_WIDTH,texture:h}),l.position.x=-b/2,l.rotation.z=Math.PI/2,l.position.y=f===INTERACTIVEWORLD.NEGATIVE_DOOR_SIDE?INTERACTIVEWORLD.DOOR_WIDTH/2:-INTERACTIVEWORLD.DOOR_WIDTH/2)),this.add(i),this.add(j),this.add(k),this.add(l)},INTERACTIVEWORLD.Room.prototype.__proto__=THREE.Object3D.prototype,INTERACTIVEWORLD.Viewer=function(a){function b(){l.setSize(window.innerWidth,window.innerHeight)}function c(){o.update(),l.render(m,n),requestAnimationFrame(c)}var d=this;a=a||{};var e=a.divID,f=a.antialias,g=a.task||0,h=[],i=0,j="";0===g&&(h=[new INTERACTIVEWORLD.Plate,new INTERACTIVEWORLD.Cup,new INTERACTIVEWORLD.Fork,new INTERACTIVEWORLD.Spoon],i=3,j="Set the table with these objects.");var k=new INTERACTIVEWORLD.ObjectMenu({antialias:f,objects:h,completion:i,title:j});k.on("completion",function(){d.emit("completion")});var l=new THREE.WebGLRenderer({antialias:f}),m=new THREE.Scene,n=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.01,1e3);m.add(new THREE.AmbientLight(6710886)),m.add(new THREE.HemisphereLight(16777215,11184810,.8));var o=new INTERACTIVEWORLD.MouseControls({scene:m,camera:n,domElement:l.domElement,objectMenu:k}),p=new INTERACTIVEWORLD.World({controls:o});m.add(p),p.interactionHandler.on("addition",function(a){d.emit("addition",a)}),window.addEventListener("resize",b,!1),b(),document.getElementById(e).appendChild(l.domElement),c()},INTERACTIVEWORLD.Viewer.prototype.__proto__=EventEmitter2.prototype,INTERACTIVEWORLD.World=function(a){a=a||[],THREE.Object3D.call(this);var b=a.controls,c=new INTERACTIVEWORLD.TexturePlane({width:INTERACTIVEWORLD.WORLD_WIDTH,height:INTERACTIVEWORLD.WORLD_HEIGHT,texture:INTERACTIVEWORLD.WORLD_FLOOR_TEXTURE,repeat:10});c.position.z=2*-INTERACTIVEWORLD.Z_INDEX,this.add(c);var d=THREE.ImageUtils.loadTextureCube([INTERACTIVEWORLD.SKY_TEXTURE,INTERACTIVEWORLD.SKY_TEXTURE,INTERACTIVEWORLD.SKY_TEXTURE,INTERACTIVEWORLD.SKY_TEXTURE,INTERACTIVEWORLD.SKY_TEXTURE,INTERACTIVEWORLD.SKY_TEXTURE]);d.format=THREE.RGBFormat;var e=THREE.ShaderLib.cube;e.uniforms.tCube.value=d,this.add(new THREE.Mesh(new THREE.CubeGeometry(INTERACTIVEWORLD.WORLD_WIDTH,INTERACTIVEWORLD.WORLD_HEIGHT,Math.max(INTERACTIVEWORLD.WORLD_WIDTH,INTERACTIVEWORLD.WORLD_HEIGHT)),new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:e.uniforms,side:THREE.BackSide})));var f=new INTERACTIVEWORLD.House({controls:b});this.add(f),this.interactionHandler=f.eventHandler},INTERACTIVEWORLD.World.prototype.__proto__=THREE.Object3D.prototype;